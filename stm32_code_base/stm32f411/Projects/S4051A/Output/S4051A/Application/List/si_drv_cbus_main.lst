###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.30.1.53127/W32 for ARM     11/Nov/2014  19:23:59 #
# Copyright 1999-2011 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Libraries\AMT_Drivers\sii953x\driver\cbus_drv\si_drv_ #
#                    cbus_main.c                                              #
#    Command line =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Libraries\AMT_Drivers\sii953x\driver\cbus_drv\si_drv_ #
#                    cbus_main.c -D S4051A -D DEBUG -D FREE_RTOS -D           #
#                    STM32F40_41xxx -D USE_STM324xG_EVAL -D                   #
#                    USE_STDPERIPH_DRIVER -D __ARM_CORTEX_MX__ -D             #
#                    IAR_ARM_CM4F -D USE_USB_OTG_FS -lcN                      #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\Output\S4051A\Application\Li #
#                    st\ -o C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\ #
#                    DevCode\2\Projects\S4051A\EWARM\..\Output\S4051A\Applica #
#                    tion\Obj\ --debug --endian=little --cpu=Cortex-M4 -e     #
#                    --fpu=VFPv4_sp --dlib_config "C:\Program Files           #
#                    (x86)\IAR Systems\Embedded Workbench                     #
#                    6.0\arm\INC\c\DLib_Config_Normal.h" -I                   #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\inc\ -I                         #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\App_SRC\ -I                  #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\App_SRC\Include\ -I          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\App_SRC\SERVICES\ -I         #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\App_SRC\SERVICES\USB_HD\inc\ #
#                     -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\Dev #
#                    Code\2\Projects\S4051A\EWARM\..\App_SRC\SERVICES\USB_HD\ #
#                    src\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2 #
#                    \DevCode\2\Projects\S4051A\EWARM\..\App_SRC\SERVICES\wav #
#                    ePlayer\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\1 #
#                    5_K2\DevCode\2\Projects\S4051A\EWARM\..\App_SRC\Managers #
#                    \ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\De #
#                    vCode\2\Projects\S4051A\EWARM\..\App_SRC\Dispatchers\    #
#                    -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevC #
#                    ode\2\Projects\S4051A\EWARM\..\..\..\Libraries\CMSIS\Inc #
#                    lude\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K #
#                    2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Libraries\CMS #
#                    IS\Device\ST\STM32F4xx\Include\ -I                       #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\STM32F4xx_St #
#                    dPeriph_Driver\inc\ -I C:\Users\tony.tsou\Desktop\AmTRAN #
#                    \Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\.. #
#                    \Libraries\FreeRTOS\Source\portable\IAR\ARM_CM4F\ -I     #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\FreeRTOS\Sou #
#                    rce\include\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projec #
#                    ts\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Librar #
#                    ies\FreeRTOS\Source\ -I C:\Users\tony.tsou\Desktop\AmTRA #
#                    N\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\. #
#                    .\Libraries\STM32_USB_OTG_Driver\inc\ -I                 #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\STM32_USB_De #
#                    vice_Library\Core\inc\ -I C:\Users\tony.tsou\Desktop\AmT #
#                    RAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\.. #
#                    \..\Libraries\STM32_USB_Device_Library\Class\cdc\inc\    #
#                    -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevC #
#                    ode\2\Projects\S4051A\EWARM\..\..\..\Libraries\STM32_USB #
#                    _HOST_Library\Core\inc\ -I C:\Users\tony.tsou\Desktop\Am #
#                    TRAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\. #
#                    .\..\Libraries\STM32_USB_HOST_Library\Class\MSC\inc\ -I  #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Utilities\Third_Party\ #
#                    efsl\inc\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\ #
#                    15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Utilities #
#                    \Third_Party\fat_fs\inc\ -I                              #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Utilities\mainstream_v #
#                    1\stm32f411\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projec #
#                    ts\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Utilit #
#                    ies\mainstream_v1\stm32f411\it\ -I                       #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    EXT_FLASH\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects #
#                    \15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Librarie #
#                    s\AMT_Drivers\TAS5727\ -I C:\Users\tony.tsou\Desktop\AmT #
#                    RAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\.. #
#                    \..\Libraries\AMT_Drivers\TAS5711\ -I                    #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    TAS5707\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\1 #
#                    5_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Libraries\ #
#                    AMT_Drivers\TAS5713\ -I C:\Users\tony.tsou\Desktop\AmTRA #
#                    N\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\. #
#                    .\Libraries\AMT_Drivers\CS49844\ -I                      #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    CS8422\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15 #
#                    _K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Libraries\A #
#                    MT_Drivers\CS5346\ -I C:\Users\tony.tsou\Desktop\AmTRAN\ #
#                    Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\ #
#                    Libraries\AMT_Drivers\OTI3368\ -I                        #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    HT68F30\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\1 #
#                    5_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Libraries\ #
#                    AMT_Drivers\BTM640\ -I C:\Users\tony.tsou\Desktop\AmTRAN #
#                    \Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\.. #
#                    \Libraries\AMT_Drivers\sii953x\application\ -I           #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_ipv\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_cbus\ -I                         #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_cdc\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_cec\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_arc\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_diag\ -I                         #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_msw\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\application\app_osd\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\ -I C:\Users\tony.tsou\Desktop\AmTRAN\ #
#                    Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\ #
#                    Libraries\AMT_Drivers\sii953x\component\tx\ -I           #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\repeater_avr\ -I                       #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\video_tables\ -I                       #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\audio_rx\ -I                           #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\edid_tx\ -I                            #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\debugger_hdmigear\ -I                  #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\cbus\ -I C:\Users\tony.tsou\Desktop\Am #
#                    TRAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\. #
#                    .\..\Libraries\AMT_Drivers\sii953x\component\rtpi\ -I    #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\cdc\ -I C:\Users\tony.tsou\Desktop\AmT #
#                    RAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\.. #
#                    \..\Libraries\AMT_Drivers\sii953x\component\cec_manager\ #
#                     -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\Dev #
#                    Code\2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Driv #
#                    ers\sii953x\component\thx\ -I                            #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\ipv\ -I C:\Users\tony.tsou\Desktop\AmT #
#                    RAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\.. #
#                    \..\Libraries\AMT_Drivers\sii953x\component\osd\ -I      #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\cec_switch\ -I                         #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\component\cec_system_audio_control\ -I           #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Pro #
#                    jects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Lib #
#                    raries\AMT_Drivers\sii953x\driver\audio_mix_drv\ -I      #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\sii953x_drv\ -I                           #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\cra_drv\ -I C:\Users\tony.tsou\Desktop\Am #
#                    TRAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\. #
#                    .\..\Libraries\AMT_Drivers\sii953x\driver\matrix_sw_drv\ #
#                     -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\Dev #
#                    Code\2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Driv #
#                    ers\sii953x\driver\nvram_sram_drv\ -I                    #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\tpi_drv\ -I C:\Users\tony.tsou\Desktop\Am #
#                    TRAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\. #
#                    .\..\Libraries\AMT_Drivers\sii953x\driver\audio_rx_drv\  #
#                    -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevC #
#                    ode\2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drive #
#                    rs\sii953x\driver\repeater_avr_drv\ -I                   #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\gpio_drv\ -I                              #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\tpg_drv\ -I C:\Users\tony.tsou\Desktop\Am #
#                    TRAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\. #
#                    .\..\Libraries\AMT_Drivers\sii953x\driver\cbus_drv\ -I   #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\cpi_drv\ -I C:\Users\tony.tsou\Desktop\Am #
#                    TRAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\. #
#                    .\..\Libraries\AMT_Drivers\sii953x\driver\arc_drv\ -I    #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\driver\osd_drv\ -I C:\Users\tony.tsou\Desktop\Am #
#                    TRAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\. #
#                    .\..\Libraries\AMT_Drivers\sii953x\driver\ipv_drv\ -I    #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\platform\hal\ir_remote\ -I                       #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\platform\hal\eeprom\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\platform\hal\timer\ -I                           #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\platform\hal\i2c\ -I                             #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\platform\osal\timer\ -I                          #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    sii953x\platform\board\ -Ohz -I "C:\Program Files        #
#                    (x86)\IAR Systems\Embedded Workbench                     #
#                    6.0\arm\CMSIS\Include\"                                  #
#    List file    =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\Output\S4051A\Application\Li #
#                    st\si_drv_cbus_main.lst                                  #
#    Object file  =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\Output\S4051A\Application\Ob #
#                    j\si_drv_cbus_main.o                                     #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode\2\Libraries\AMT_Drivers\sii953x\driver\cbus_drv\si_drv_cbus_main.c
      1          /******************************************************************************/
      2          //!file     si_drv_cbus.c
      3          //!brief    SiI9687 CBUS Driver.
      4          //
      5          // NOTE: This driver has a dependency on the Switch driver for the 9687
      6          //
      7          // No part of this work may be reproduced, modified, distributed,
      8          // transmitted, transcribed, or translated into any language or computer
      9          // format, in any form or by any means without written permission of
     10          // Silicon Image, Inc., 1060 East Arques Avenue, Sunnyvale, California 94085
     11          //
     12          // Copyright 2007-2011, Silicon Image, Inc.  All rights reserved.
     13          /******************************************************************************/
     14          
     15          #include "string.h"
     16          #include "si_drv_cbus_internal.h"
     17          #include "si_cbus_enums.h"
     18          #include "si_drv_internal.h"
     19          #include "si_drv_switch.h"
     20          #include "si_drv_gpio.h"
     21          #include "si_cbus_component.h"
     22          #include "si_drv_cbus.h"
     23          
     24          //------------------------------------------------------------------------------
     25          //  CBUS Driver Instance Data
     26          //------------------------------------------------------------------------------
     27          
     28          CbusDrvInstanceData_t cbusDrvInstance[SII_NUM_CBUS];
     29          CbusDrvInstanceData_t *pDrvCbus = &cbusDrvInstance[0];
     30          
     31          //------------------------------------------------------------------------------
     32          //  CBUS Driver local Data
     33          //------------------------------------------------------------------------------
     34          
     35          static uint16_t cbusInitCbusRegsList [32] =
     36          {
     37              REG_CBUS_DEVICE_CAP_1, 		MHL_VERSION,
     38              REG_CBUS_DEVICE_CAP_2,		MHL_DEV_CAT_POW,			// MHL PLIM0/PLIM1 needs to be set according to VBUS power it can supply
     39              REG_CBUS_DEVICE_CAP_3,      MHL_DEV_CAT_ADOPTER_ID_H,
     40              REG_CBUS_DEVICE_CAP_4,      MHL_DEV_CAT_ADOPTER_ID_L,
     41              REG_CBUS_DEVICE_CAP_5,      MHL_VID_LINK_MODE,
     42              REG_CBUS_DEVICE_CAP_6,      MHL_AUDIO_LINK_MODE,    // Bug 33183 - Melbourne SiI9535 | UTS800 SL850 MHL CBUS CTS test | 6.3.1.1 fails.
     43              REG_CBUS_DEVICE_CAP_7,      MHL_VIDEO_TYPE,
     44              REG_CBUS_DEVICE_CAP_8,      MHL_LOG_DEV_MAP,
     45              REG_CBUS_DEVICE_CAP_9,      MHL_BANDWIDTH_LIMIT,
     46              REG_CBUS_DEVICE_CAP_A,      MHL_FEATURE_SUPPORT,
     47              REG_CBUS_DEVICE_CAP_B,      MHL_DEVICE_ID_H,
     48              REG_CBUS_DEVICE_CAP_C,      MHL_DEVICE_ID_L,
     49              REG_CBUS_DEVICE_CAP_D,      MHL_SCRATCHPAD_SIZE,
     50              REG_CBUS_DEVICE_CAP_E,      MHL_INT_STAT_SIZE,
     51              REG_CBUS_DEVICE_CAP_F,      0x00
     52          };
     53          
     54          
     55          //------------------------------------------------------------------------------
     56          // Description: Set the active cbus port
     57          // Parameters:  instanceIndex
     58          // Returns:     true if legal index, false if index value is illegal.
     59          //------------------------------------------------------------------------------
     60          void SiiDrvCbusConfigure ( uint8_t port )
     61          {
     62              pDrvCbus->port = port;
     63          }
     64          
     65          //------------------------------------------------------------------------------
     66          // Description: Set the driver global data pointer to the requested instance.
     67          // Parameters:  instanceIndex
     68          // Returns:     true if legal index, false if index value is illegal.
     69          //------------------------------------------------------------------------------
     70          
     71          bool_t SiiDrvCbusInstanceSet ( uint_t instanceIndex )
     72          {
     73              if ( instanceIndex < SII_NUM_CBUS )
     74              {
     75                  SiiRegInstanceSet( CBUS_PAGE, instanceIndex );
     76                  pDrvCbus = &cbusDrvInstance[ instanceIndex];
     77                  pDrvCbus->instanceIndex = instanceIndex;
     78                  return( true );
     79              }
     80          
     81              return( false );
     82          }
     83          
     84          //------------------------------------------------------------------------------
     85          // Function:    SiiDrvCbusInstanceGet
     86          // Description: Return the current instance index.
     87          // Parameters:  none
     88          // Returns:     instance index.
     89          //------------------------------------------------------------------------------
     90          
     91          int_t SiiDrvCbusInstanceGet ( void )
     92          {
     93              return( pDrvCbus->instanceIndex );
     94          }
     95          
     96          //------------------------------------------------------------------------------
     97          // Function:    SiiDrvCbusStatus
     98          // Description: Returns a status flag word containing CBUS driver-specific
     99          //              information about the state of the device.
    100          // Parameters:  none
    101          // Returns:     Sixteen-bit status flags word for the CBUS Driver
    102          //------------------------------------------------------------------------------
    103          
    104          uint16_t SiiDrvCbusStatus ( void )
    105          {
    106              uint16_t statusFlags;
    107          
    108              statusFlags = pDrvCbus->statusFlags;
    109          //    pDrvCbus->statusFlags &= ~SiiCBUS_INT;  // INT flag only valid first time it is read.
    110          
    111              return( statusFlags );
    112          }
    113          
    114          //------------------------------------------------------------------------------
    115          // Description: Initialize the CBUS hardware for the current instance.
    116          // Returns:     TRUE if no problem
    117          //
    118          // Note:        Requires that SiiDrvCbusInstanceSet() is called prior to this call
    119          //------------------------------------------------------------------------------
    120          bool_t SiiDrvCbusInitialize ( void )
    121          {
    122              uint_t  instanceIndex, index;
    123              uint8_t mhlPortBits;
    124          
    125              // Clear instance data
    126              instanceIndex = pDrvCbus->instanceIndex;        // Remember our instance
    127              memset( pDrvCbus, 0, sizeof( CbusDrvInstanceData_t ));
    128              pDrvCbus->instanceIndex = instanceIndex;        // Restore our instance
    129          
    130          /*
    131              //Set Min and Max discover pulse width
    132              //This gives us ~153.5us if OSC=20MHz and ~139.6us if OSC=22MHz (20MHz + 10%).
    133              SiiRegWrite( REG_CBUS_DISC_PWIDTH_MIN, 0x4E );
    134              SiiRegWrite( REG_CBUS_DISC_PWIDTH_MAX, 0xC0 );
    135          
    136              // Set default CBUS bit offset
    137              SiiRegModify(REG_CBUS_LINK_CTRL11, MSK_CBUS_LINK_BIT_OFFSET, 0x4 << SFT_CBUS_LINK_BIT_OFFSET);
    138              */
    139          
    140              // Setup local DEVCAP registers for read by the peer per rc7
    141              for ( index = 0; index < (sizeof( cbusInitCbusRegsList) / 2); index += 2 )
    142              {
    143                  SiiRegWrite( cbusInitCbusRegsList[ index], cbusInitCbusRegsList[ index + 1] );
    144              }
    145          
    146              // Enable the VS commands, all interrupts, and clear legacy
    147              SiiRegWrite( REG_CBUS_INTR_0_MASK, 0xFF );      // Enable desired interrupts
    148              SiiRegWrite( REG_CBUS_INTR_1_MASK, 0x4C );      // Enable desired interrupts
    149          
    150              //SiiRegWrite( REG_CBUS_SET_INT_0_MASK, 0xFF );   // Enable desired interrupts for SET_INT
    151              //SiiRegWrite( REG_CBUS_SET_INT_1_MASK, 0xFF );   // Enable desired interrupts for SET_INT
    152          
    153          
    154              //DEBUG_PRINT( MSG_ALWAYS, "\nINITIALIZING MHL\n" );
    155              mhlPortBits = SiiDrvCbusPortSelectBitsGet();      // Get the MHL selected port bit-field.
    156          
    157             // DEBUG_PRINT( MSG_ERR, "\nMHL: Ports Selected from NVRAM: %d \n",mhlPortBits  );
    158          
    159              SiiRegWrite( REG_MHL_1X2X_PORT_REG2, 0x00 );
    160          
    161          	//Enable Cbus Cable sense
    162              SiiRegWrite( REG_CH0_INTR4_MASK, mhlPortBits );
    163          
    164              // Set up both MHL GPIOs for cable sense.
    165          //  TODO: GPIO used for MHL Cable Detect
    166              SiiDrvGpioPinType( SII_GPIO_PIN_0, SII_GPIO_ALT_MHL_CABLE_CONN0 );
    167             
    168              SiiDrvGpioPinConfigure(
    169                      SII_GPIO_PIN_0,
    170                      SII_GPIO_INPUT | SII_GPIO_PD | SII_GPIO_INT_RISING_EDGE | SII_GPIO_INT_FALLING_EDGE );
    171          
    172              SiiDrvGpioIntEnable( SII_GPIO_PIN_0, SII_GPIO_PIN_0 );
    173          
    174              // Override CBUS port select over NVRAM selection. Select Port 0 and Port 1
    175              SiiRegWrite( REG_HDMIM_HPD_OVRD_CTRL, (BIT_MHL_PORT_SEL_FORCE | BIT_MHL_SEL_PORT0 | BIT_MHL_SEL_PORT1) );
    176          
    177              // use 1/3x clock input in MHL mode0: 1x input (default)1:1/3x input clock in MHL
    178             // SiiRegWrite( REG_TMDS0_CTRL2, REG_MHL_TEST_SOFT_CTRL_1X);
    179          
    180              // PLL configuration
    181             // SiiRegWrite( REG_TMDS0_CTRL3, 0x00);
    182          
    183              // Packed Pixed mode
    184              //SiiRegWrite( REG_PAUTH_MHL_CFG2, 0xC1);
    185          
    186              // Packed Pixed mode
    187              //SiiRegWrite( REG_PAUTH_MHL_CFG3, 0x01);
    188          
    189          
    190          
    191          
    192              return( true );
    193          }

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        0  SiiDrvCbusConfigure
       16  SiiDrvCbusInitialize
             16 -> SiiDrvCbusPortSelectBitsGet
             16 -> SiiDrvGpioIntEnable
             16 -> SiiDrvGpioPinConfigure
             16 -> SiiDrvGpioPinType
             16 -> SiiRegWrite
             16 -> __aeabi_memclr4
        0  SiiDrvCbusInstanceGet
        8  SiiDrvCbusInstanceSet
              8 -> SiiRegInstanceSet
        0  SiiDrvCbusStatus


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable4
       8  SiiDrvCbusConfigure
     124  SiiDrvCbusInitialize
       8  SiiDrvCbusInstanceGet
      40  SiiDrvCbusInstanceSet
       8  SiiDrvCbusStatus
     132  cbusInitCbusRegsList
          pDrvCbus
          cbusDrvInstance

 
 132 bytes in section .data
 192 bytes in section .text
 
 192 bytes of CODE memory
 132 bytes of DATA memory

Errors: none
Warnings: 2
