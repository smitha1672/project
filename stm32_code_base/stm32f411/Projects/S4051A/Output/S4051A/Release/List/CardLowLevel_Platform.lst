###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.30.1.53127/W32 for ARM     10/Nov/2014  15:08:52 #
# Copyright 1999-2011 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Utilities\mainstream_v1\stm32f411\CardLowLevel_Platfo #
#                    rm.c                                                     #
#    Command line =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Utilities\mainstream_v1\stm32f411\CardLowLevel_Platfo #
#                    rm.c -D __ARM_CORTEX_MX__ -D DEBUG -D FREE_RTOS -D       #
#                    STM32F40_41xxx -D USE_STM324xG_EVAL -D                   #
#                    USE_STDPERIPH_DRIVER -D HOST_MODE_ENABLED -D             #
#                    IAR_ARM_CM4F -D USE_USB_OTG_FS -D STM32_IAP -D S4051A    #
#                    -lcN C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\De #
#                    vCode\2\Projects\S4051A\EWARM\..\Output\S4051A\Release\L #
#                    ist\ -o C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2 #
#                    \DevCode\2\Projects\S4051A\EWARM\..\Output\S4051A\Releas #
#                    e\Obj\ --debug --endian=little --cpu=Cortex-M4 -e        #
#                    --fpu=VFPv4_sp --dlib_config "C:\Program Files           #
#                    (x86)\IAR Systems\Embedded Workbench                     #
#                    6.0\arm\INC\c\DLib_Config_Normal.h" -I                   #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\inc\ -I                         #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Projects\STM32_IAP\inc #
#                    \ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\De #
#                    vCode\2\Projects\S4051A\EWARM\..\..\..\Libraries\CMSIS\I #
#                    nclude\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15 #
#                    _K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Libraries\C #
#                    MSIS\Device\ST\STM32F4xx\Include\ -I                     #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\STM32F4xx_St #
#                    dPeriph_Driver\inc\ -I C:\Users\tony.tsou\Desktop\AmTRAN #
#                    \Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\.. #
#                    \Libraries\FreeRTOS\Source\portable\IAR\ARM_CM4F\ -I     #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\FreeRTOS\Sou #
#                    rce\include\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projec #
#                    ts\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Librar #
#                    ies\FreeRTOS\Source\ -I C:\Users\tony.tsou\Desktop\AmTRA #
#                    N\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\. #
#                    .\Libraries\STM32_USB_OTG_Driver\inc\ -I                 #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\STM32_USB_HO #
#                    ST_Library\Core\inc\ -I C:\Users\tony.tsou\Desktop\AmTRA #
#                    N\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\. #
#                    .\Libraries\STM32_USB_HOST_Library\Class\MSC\inc\ -I     #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Libraries\AMT_Drivers\ #
#                    EXT_FLASH\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects #
#                    \15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Librarie #
#                    s\AMT_Drivers\HT68F30\ -I C:\Users\tony.tsou\Desktop\AmT #
#                    RAN\Projects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\.. #
#                    \..\Utilities\Third_Party\efsl\inc\ -I                   #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Utilities\Third_Party\ #
#                    fat_fs\inc\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Project #
#                    s\15_K2\DevCode\2\Projects\S4051A\EWARM\..\..\..\Utiliti #
#                    es\mainstream_v1\stm32f411\ -I                           #
#                    C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\..\..\Utilities\mainstream_v #
#                    1\stm32f411\it\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Pro #
#                    jects\15_K2\DevCode\2\Projects\S4051A\EWARM\..\APP_SRC\I #
#                    nclude\ -I C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15 #
#                    _K2\DevCode\2\Projects\S4051A\EWARM\..\APP_SRC\ -Ohz -I  #
#                    "C:\Program Files (x86)\IAR Systems\Embedded Workbench   #
#                    6.0\arm\CMSIS\Include\"                                  #
#    List file    =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\Output\S4051A\Release\List\C #
#                    ardLowLevel_Platform.lst                                 #
#    Object file  =  C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode #
#                    \2\Projects\S4051A\EWARM\..\Output\S4051A\Release\Obj\Ca #
#                    rdLowLevel_Platform.o                                    #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\tony.tsou\Desktop\AmTRAN\Projects\15_K2\DevCode\2\Utilities\mainstream_v1\stm32f411\CardLowLevel_Platform.c
      1          #include "Debug.h"
      2          #include "freertos_conf.h"
      3          #include "device_config.h"
      4          #include "CardLowLevel_Platform.h"
      5          //#include "stm3210c_usb_audio_codec.h"
      6          
      7          #if !defined ( STM32_IAP )
      8          #include "EepromDriver.h"
      9          #include "CS8422_ISR_Handler.h"
     10          #endif
     11          
     12          
     13          
     14          //!	< External Application ___________________________________________________________________________________@{
     15          //These applicatons is only used on here.
     16          extern void CardLowLevel_initializeCard(void);
     17          
     18          extern void SPILowLevel_initialize( void );
     19          
     20          extern void SPILowLevel_Deinitialize( void );
     21          
     22          extern void GPIOLowLevel_Configuration( );
     23          
     24          extern void IRLowLevel_initialize(void);
     25          
     26          extern void IRLowLevelDecoder_CreateTask( void );
     27          
     28          extern void CPU_resetMicroController( void );
     29          
     30          extern void SiiPlatform_InterruptConfig_STM32( void );
     31          
     32          //!	@}
     33          
     34          
     35          /*_______________________________________________________________________________________________*/
     36          static void CardLowLevelPlatform_GPIOInitialize(void)
     37          {
     38          	GPIOLowLevel_Configuration( );
     39          	
     40          #ifdef BTMUTE_ENABLE      //Jerry add for BTmute    
     41          	//BTMuteGpio_initialize();     //Jerry add for BT_INF detect mute function.
     42          #endif
     43          
     44          	GPIOMiddleLevel_Clr(__O_DE_5V);
     45          	GPIOMiddleLevel_Clr(__O_RX_PD);   //RF-RX Power down
     46          	GPIOMiddleLevel_Clr(__O_BT_MFB);
     47          
     48          	//! GPIO Default setting.	@{
     49          	GPIOMiddleLevel_Set( __O_MCU_EEPROM_WP );  //High EEPROM Unprotect so set Low
     50          	GPIOMiddleLevel_Clr( __O_RST_RF );
     51          	GPIOMiddleLevel_Clr( __O_RF_PAIRING );
     52          	
     53          	//! Device reset pin
     54          	GPIOMiddleLevel_Clr( __O_CS8422_RST );
     55          	GPIOMiddleLevel_Clr( __O_CS5346_RST );
     56          	GPIOMiddleLevel_Clr( __O_DSP_RES );
     57          	GPIOMiddleLevel_Clr( __O_MUTE_AMP );
     58          	
     59          	GPIOMiddleLevel_Set( __O_EXT_FLASH_CS );
     60          	//! @}
     61          
     62          	//! USB Swith Default is MCU path@{
     63          	//GPIOMiddleLevel_Set(__O_USB_VBUS);//vbus
     64          	GPIOMiddleLevel_Clr( __O_USB_VIN );
     65          	
     66          	GPIOMiddleLevel_Clr( __O_EN_1V );
     67          	//!}
     68                  
     69          	GPIOMiddleLevel_Clr( __O_MUTE_REAR);	
     70          
     71          	GPIOMiddleLevel_Clr( __O_RST_HDMI_SIL953x );
     72          }
     73          
     74          #if ( configEEPROM == 1 ) && !defined ( STM32_IAP ) 
     75          static void CardlowLevelPlatform_mapEeproms()
     76          {
     77              /* Initialize the EEPROM driver */
     78              EepromDriver_initialize();
     79          
     80              EepromDriver_mapLogicalToPhysical(LOGICAL_EEPROM_DEVICE_BLOCK0,
     81                                      0xA0,
     82                                      EEPROM_DEVICE_0_CAPACITY_BYTE,
     83                                      EEPROM_DEVICE_0_PAGE_SIZE_BYTE,
     84                                      EEPROM_DEVICE_0_CHUNK_SIZE_BYTE);
     85          
     86          }
     87          #endif 
     88          
     89          void CardLowLevelPlatform_initializeCard(void)
     90          {
     91          	CardLowLevel_initializeCard();
     92          
     93              IRLowLevel_initialize();
     94          
     95          	IRLowLevelDecoder_CreateTask();
     96          
     97          	CardLowLevelPlatform_GPIOInitialize( );
     98          
     99              /*Smith check*/
    100          #if ( configCS8422_ISR == 1 )    
    101              //CS8422_ISR_IntConfig( );
    102          #endif 
    103          
    104          #if ( configSIL953x_ISR == 1 )
    105          	//SiiPlatform_InterruptConfig_STM32( );
    106          #endif
    107          
    108          	TWI_initialize( );
    109          
    110              /*I2C-2 configure*/
    111          	TWI2_initialize( );
    112          
    113              /*SPI is for DSP and SPI flahs control*/
    114          	//SPILowLevel_initialize( );
    115          
    116          #if ( configI2S_OUT == 1 )
    117          	//EVAL_AUDIO_Init(0, 65, 44100);
    118          #endif 	
    119          
    120          #if ( configEEPROM == 1 ) 
    121          	/*initial eeprom address*/
    122          	CardlowLevelPlatform_mapEeproms();	
    123          #endif /*EEPROM*/
    124          	
    125          }
    126          
    127          void CardLowLevelPlatform_resetSystem(void)
    128          {
    129          	CPU_resetMicroController();
    130          }
    131          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        8  CardLowLevelPlatform_initializeCard
             8 -> CardLowLevel_initializeCard
             0 -> CardlowLevelPlatform_mapEeproms
             8 -> GPIOLowLevel_Configuration
             8 -> GPIOMiddleLevel_Clr
             8 -> GPIOMiddleLevel_Set
             8 -> IRLowLevelDecoder_CreateTask
             8 -> IRLowLevel_initialize
             8 -> TWI2_initialize
             8 -> TWI_initialize
        0  CardLowLevelPlatform_resetSystem
             0 -> CPU_resetMicroController


   Section sizes:

   Bytes  Function/Label
   -----  --------------
     124  CardLowLevelPlatform_initializeCard
       4  CardLowLevelPlatform_resetSystem

 
 128 bytes in section .text
 
 128 bytes of CODE memory

Errors: none
Warnings: 2
